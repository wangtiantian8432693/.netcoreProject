<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>跨域</title>
    <script src="http://apps.bdimg.com/libs/jquery/1.6.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>
    <style type="text/css">
        table {
            border-collapse: collapse;
            margin: 0 auto;
            text-align: center;
        }

            table td, table th {
                border: 1px solid #cad9ea;
                color: #666;
                height: 30px;
            }

            table thead th {
                background-color: #CCE8EB;
                width: 100px;
            }

            table tr:nth-child(odd) {
                background: #fff;
            }

            table tr:nth-child(even) {
                background: #F5FAFA;
            }
    </style>
    <script type="text/javascript">


    

        //导出pdf
        function htmlToPdf() {
            if (confirm("您确认下载该PDF文件吗?")) {
                var pdf = new jsPDF('p', 'pt', 'a4');
                // 设置打印比例 越大打印越小
                pdf.internal.scaleFactor = 2;
                var options = {
                    pagesplit: true, //设置是否自动分页
                    "background": '#FFFFFF'   //如果导出的pdf为黑色背景，需要将导出的html模块内容背景 设置成白色。
                };
                var printHtml = $('#table').get(0);   // 页面某一个div里面的内容，通过id获取div内容
                pdf.addHTML(printHtml, 15, 15, options, function () {
                    pdf.save('目标.pdf');
                });
            }
        }

        $(function () {

            //获取API数据
            $('#test').click(function () {

                var url = "http://172.16.20.193:8080/api/APS/Login";

                alert(0);
                $.ajax({
                    url: url,
                    type: 'post',
                    dataType: "json",
                    crossDomain: true,
                    data: {
                        "AppInfo": {
                            "appVersion": "1.0",
                            "challenge": "false",
                            "client": "Android",
                            "sysVersion": "1.0",
                            "timeStamp": "1"
                        },
                        "Body": {
                            "UserName": "7000003",
                            "PassWord": "123456"
                        }
                    },
                    success: function (info) {
                        $("#content").html(JSON.stringify(info));
                    }
                });
            });

        });

    </script>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            <input type="button" value=" 获取API数据 " id="test" />
            <input type="text" id="url" style="width: 300px;" />
            <br />
            <div id="content">这里是返回API数据结果</div>
        </div>
        <hr />

        <input type="button" value=" JS导出pdf " onclick="htmlToPdf()" />
        <table width="90%" class="table" style="display: none;">
            <caption>
                <h2>
                    车间能源消耗比例
                </h2>
            </caption>
            <thead>
                <tr>
                    <th> 车间</th>
                    <th> 产量</th>
                    <th> 电量</th>
                    <th> 单耗</th>
                </tr>
            </thead>
            <tr>
                <td>
                    109
                </td>
                <td>
                    13
                </td>
                <td>
                    1.34
                </td>
                <td>
                    213
                </td>
            </tr>
            <tr>
                <td>
                    109
                </td>
                <td>
                    13
                </td>
                <td>
                    1.34
                </td>
                <td>
                    213
                </td>
            </tr>
            <tr>
                <td>
                    109
                </td>
                <td>
                    13
                </td>
                <td>
                    1.34
                </td>
                <td>
                    213
                </td>
            </tr>
            <tr>
                <td>
                    109
                </td>
                <td>
                    13
                </td>
                <td>
                    1.34

                </td>

                <td>

                    213

                </td>

            </tr>

            <tr>

                <td>

                    109

                </td>

                <td>

                    13

                </td>

                <td>

                    1.34

                </td>

                <td>

                    213

                </td>

            </tr>

            <tr>

                <td>

                    109

                </td>

                <td>

                    13

                </td>

                <td>

                    1.34

                </td>

                <td>

                    213

                </td>

            </tr>

        </table>

    </form>
</body>

</html>